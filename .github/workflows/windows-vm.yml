name: Windows VM Runner

on:
  workflow_dispatch:
    inputs:
      hours:
        description: 'How many hours to run?'
        required: true
        default: '6'
        type: choice
        options:
          - '2'
          - '4'
          - '6'

jobs:
  windows-vm:
    runs-on: windows-latest
    timeout-minutes: 360  # 6 hours fixed
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      
    - name: Setup Windows VM
      run: |
        Write-Host "ğŸ‰ Your FREE Windows VM is running!"
        Write-Host "ğŸ“ VM Type: Windows Server 2022"
        Write-Host "â° Time Remaining: 6 hours"
        Write-Host "ğŸ’» CPU: 2-core, RAM: 7GB, Storage: 14GB"
        Write-Host "ğŸŒ Internet: Available"
        Write-Host "ğŸ“ Your files are available in this repository"
        
    - name: Install basic software
      run: |
        # Chrome install karein
        winget install --id Google.Chrome -e --accept-package-agreements
        # Notepad++ install karein  
        winget install --id Notepad++.Notepad++ -e --accept-package-agreements
        
    - name: Keep VM running
      run: |
        Write-Host "VM will run for 6 hours (21600 seconds)"
        Start-Sleep -Seconds 21600
